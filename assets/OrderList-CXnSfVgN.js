import{_ as I,y as P,f as O,c as n,b as s,l as c,t as o,e as y,F as b,s as m,u as j,o as l,n as d,r as z,x as V,z as G,p as f}from"./index-Ct52L6Yp.js";const M={class:"p-4 pb-24 space-y-3 bg-slate-50 min-h-screen font-sans"},$={class:"flex justify-between items-center mb-2"},F={class:"text-[10px] bg-slate-200 px-2 py-1 rounded-lg font-bold text-slate-500 uppercase"},S={class:"flex gap-2 text-xs font-bold overflow-x-auto pb-4 no-scrollbar"},R=["onClick"],T={key:0,class:"text-center py-20 text-slate-400"},U={key:1,class:"text-center py-20"},B={class:"bg-white rounded-2xl shadow-sm border border-slate-100 relative overflow-hidden h-28 flex z-20"},q=["onClick"],X={class:"space-y-1"},H={class:"font-black text-slate-800 leading-tight truncate w-48 text-base"},J={class:"text-sm font-bold text-blue-600"},K={class:"flex gap-1.5 mt-2"},Q=["onClick"],W={class:"absolute right-0 top-0 bottom-0 z-10 flex h-full bg-slate-50"},Y=["onClick"],Z=["onClick"],tt=["onClick"],et={key:0,class:"bg-white/60 border-x border-b border-slate-100 rounded-b-2xl -mt-4 pt-6 p-4 space-y-3 z-10 shadow-inner"},st={key:0,class:"flex items-center justify-center py-4 gap-2"},at={key:1,class:"space-y-2"},nt={class:"flex gap-3 items-center"},lt={class:"h-6 w-6 flex items-center justify-center bg-slate-100 rounded-lg font-black text-slate-700"},it={class:"flex flex-col"},ot={class:"font-bold text-slate-800"},rt={class:"font-black text-slate-700"},ct={class:"pt-2 border-t border-dashed border-slate-200 flex justify-between items-center px-1"},dt={class:"text-[10px] font-bold text-slate-400 uppercase"},ut={class:"text-xs font-black text-slate-800"},ft={key:2,class:"text-center py-2 text-[10px] font-bold text-slate-400 uppercase tracking-tighter"},xt={__name:"OrderList",setup(pt){const i=P(),u=z("ALL");O(async()=>{await i.fetchOrders()});async function g(t){if(t._showActions){t._showActions=!1;return}if(t._expanded=!t._expanded,t._expanded&&(!t.items||t.items.length===0)){t._loadingItems=!0;try{await i.fetchOrderDetails(t.order_id)}finally{t._loadingItems=!1}}}function v(t){t._showActions||(t._expanded=!1),i.items.forEach(a=>{a.order_id!==t.order_id&&(a._showActions=!1)}),t._showActions=!t._showActions}function k(t){const a=t.payment_status==="UNPAID",e=t.delivery_status==="PENDING"&&t.payment_status!=="CANCELLED";return a||e}function w(t){let a=0;return t.payment_status==="UNPAID"&&a++,t.delivery_status==="PENDING"&&t.payment_status!=="CANCELLED"&&a++,t.payment_status==="UNPAID"&&t.delivery_status==="PENDING"&&a++,a*64}const x=y(()=>{let t=i.items;switch(t.forEach(a=>{a._showActions===void 0&&(a._showActions=!1),a._expanded===void 0&&(a._expanded=!1),a._loadingItems===void 0&&(a._loadingItems=!1)}),u.value){case"PENDING":return t.filter(h);case"COMPLETED":return t.filter(_);case"CANCELLED":return t.filter(p);default:return t}}),C=y(()=>[{key:"ALL",label:"All",count:i.items.length,badge:"bg-slate-100 text-slate-500"},{key:"PENDING",label:"Pending",count:i.items.filter(h).length,badge:"bg-amber-100 text-amber-600"},{key:"COMPLETED",label:"Done",count:i.items.filter(_).length,badge:"bg-emerald-100 text-emerald-600"},{key:"CANCELLED",label:"Void",count:i.items.filter(p).length,badge:"bg-red-100 text-red-600"}]);function E(t){t._showActions=!1,i.markPaid(t)}function D(t){t._showActions=!1,i.markDelivered(t)}function N(t){confirm("Void this order?")&&(t._showActions=!1,i.cancel(t))}function A(t){return t==="PAID"?"bg-emerald-100 text-emerald-700":"bg-amber-100 text-amber-700 animate-pulse"}function L(t){return t==="DELIVERED"?"bg-sky-100 text-sky-700":"bg-slate-100 text-slate-500"}function p(t){return t.payment_status==="CANCELLED"||t.delivery_status==="CANCELLED"}function _(t){return t.payment_status==="PAID"&&t.delivery_status==="DELIVERED"}function h(t){return!p(t)&&!_(t)}return(t,a)=>(l(),n("div",M,[s("div",$,[a[0]||(a[0]=s("h2",{class:"text-xl font-black text-slate-800 tracking-tight"},"Orders",-1)),s("span",F,o(x.value.length)+" Orders ",1)]),s("div",S,[(l(!0),n(b,null,m(C.value,e=>(l(),n("button",{key:e.key,onClick:r=>u.value=e.key,class:d(["px-5 py-2.5 rounded-2xl border flex items-center gap-2 transition-all whitespace-nowrap shadow-sm",u.value===e.key?"bg-slate-800 text-white border-slate-800":"bg-white text-slate-500 border-slate-100"])},[V(o(e.label)+" ",1),s("span",{class:d(["px-2 py-0.5 rounded-full text-[10px]",u.value===e.key?"bg-white/20 text-white":e.badge])},o(e.count),3)],10,R))),128))]),j(i).loading?(l(),n("div",T,[...a[1]||(a[1]=[s("div",{class:"animate-spin inline-block w-8 h-8 border-4 border-slate-300 border-t-slate-800 rounded-full mb-4"},null,-1),s("p",{class:"font-bold text-sm"},"Synchronizing Orders...",-1)])])):x.value.length===0?(l(),n("div",U,[...a[2]||(a[2]=[s("i",{class:"fa fa-file-text-o text-5xl text-slate-200 mb-4"},null,-1),s("p",{class:"text-slate-400 font-medium"},"No orders found in this category.",-1)])])):c("",!0),(l(!0),n(b,null,m(x.value,e=>(l(),n("div",{key:e.order_id,class:"flex flex-col mb-4"},[s("div",B,[s("div",{class:"absolute inset-0 z-20 bg-white p-4 flex justify-between items-center transition-transform duration-300 ease-out",style:G({transform:e._showActions?`translateX(-${w(e)}px)`:"translateX(0)"}),onClick:r=>g(e)},[s("div",X,[s("div",H,o(e.customer_name),1),s("div",J," RM "+o(Number(e.total_amount).toFixed(2)),1),s("div",K,[s("span",{class:d(["text-[8px] uppercase tracking-tighter font-black px-2 py-1 rounded-lg",A(e.payment_status)])},o(e.payment_status),3),s("span",{class:d(["text-[8px] uppercase tracking-tighter font-black px-2 py-1 rounded-lg",L(e.delivery_status)])},o(e.delivery_status),3)])]),k(e)?(l(),n("button",{key:0,onClick:f(r=>v(e),["stop"]),class:"w-12 h-12 flex items-center justify-center text-slate-300 active:text-blue-500 transition-colors"},[s("i",{class:d(["fa text-2xl transition-transform duration-300",e._showActions?"fa-chevron-right":"fa-chevron-left"])},null,2)],8,Q)):c("",!0)],12,q),s("div",W,[e.payment_status==="UNPAID"&&e.payment_status!=="CANCELLED"?(l(),n("button",{key:0,class:"w-16 bg-emerald-500 text-white flex flex-col items-center justify-center gap-1 active:bg-emerald-600",onClick:f(r=>E(e),["stop"])},[...a[3]||(a[3]=[s("i",{class:"fa fa-check-circle text-xl"},null,-1),s("span",{class:"text-[9px] font-black uppercase"},"Paid",-1)])],8,Y)):c("",!0),e.delivery_status==="PENDING"&&e.payment_status!=="CANCELLED"?(l(),n("button",{key:1,class:"w-16 bg-sky-500 text-white flex flex-col items-center justify-center gap-1 active:bg-sky-600",onClick:f(r=>D(e),["stop"])},[...a[4]||(a[4]=[s("i",{class:"fa fa-truck text-xl"},null,-1),s("span",{class:"text-[9px] font-black uppercase"},"Sent",-1)])],8,Z)):c("",!0),e.payment_status==="UNPAID"&&e.delivery_status==="PENDING"?(l(),n("button",{key:2,class:"w-16 bg-rose-400 text-white flex flex-col items-center justify-center gap-1 active:bg-rose-500",onClick:f(r=>N(e),["stop"])},[...a[5]||(a[5]=[s("i",{class:"fa fa-times text-xl"},null,-1),s("span",{class:"text-[9px] font-black uppercase"},"Void",-1)])],8,tt)):c("",!0)])]),e._expanded?(l(),n("div",et,[e._loadingItems?(l(),n("div",st,[...a[6]||(a[6]=[s("div",{class:"animate-spin w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full"},null,-1),s("span",{class:"text-[11px] font-bold text-slate-400 uppercase tracking-widest"},"Fetching Details",-1)])])):e.items&&e.items.length?(l(),n("div",at,[(l(!0),n(b,null,m(e.items,r=>(l(),n("div",{key:r.order_item_id,class:"flex justify-between items-center text-xs bg-white p-2 rounded-xl border border-slate-50 shadow-sm"},[s("div",nt,[s("span",lt,o(r.qty),1),s("div",it,[s("span",ot,o(r.product_name),1)])]),s("div",rt," RM "+o((r.price*r.qty).toFixed(2)),1)]))),128)),s("div",ct,[s("span",dt,"Total Items: "+o(e.items.length),1),s("span",ut,"RM "+o(Number(e.total_amount).toFixed(2)),1)])])):(l(),n("div",ft," No item data available "))])):c("",!0)]))),128))]))}},bt=I(xt,[["__scopeId","data-v-e39fe359"]]);export{bt as default};
