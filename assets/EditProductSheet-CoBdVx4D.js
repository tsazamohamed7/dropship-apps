import{v as u,a as p,d as g,j as b,w as k,x as h,c as _,k as v,o as w,b as s,t as y,z as a,B as c,s as P}from"./index-DKYVYWGX.js";const n={getAll(e="ACTIVE"){return p({resource:"product",status:e})},getById(e){return p({resource:"product",id:e})},getSimpleList(){return p({resource:"product",method:"LIST_SIMPLE"})},create(e){return u({resource:"product",method:"POST",...e})},update(e){return u(e)},delete(e){return u({resource:"product",method:"DELETE",product_id:e})}},L=g("product",{state:()=>({items:[],simpleItems:[],loading:!1,error:null}),actions:{async fetchProducts(e="ACTIVE"){this.loading=!0,this.error=null;try{const l=await n.getAll(e);this.items=l.data||[]}catch(l){this.error=l.message||"Failed to load products"}finally{this.loading=!1}},async fetchSimpleProducts(){if(!this.simpleItems.length)try{const e=await n.getSimpleList();this.simpleItems=e.data||[]}catch(e){console.error("Failed to fetch simple products",e)}},async addProduct(e){b().info("Adding product..."),await n.create(e),await this.fetchProducts()},async updateProduct(e){const l=b(),i=this.items.findIndex(o=>o.product_id===e.product_id);if(i===-1)return;const d={...this.items[i]};this.items[i]={...e};try{const o={resource:"product",method:"PUT",product_id:e.product_id,name:e.name,sku:e.sku,sell_price:e.sell_price,cost_price:e.cost_price,stock:e.stock,status:e.status};await n.update(o),l.success("Product updated")}catch(o){this.items[i]=d,console.error("Update product failed",o),l.error("Failed to update product")}},async deleteProduct(e){await n.delete(e),await this.fetchProducts()}}}),S={class:"flex justify-between items-center border-b pb-2"},C={class:"text-lg font-bold text-slate-800"},E={class:"space-y-4"},I={class:"flex flex-col gap-1"},V={class:"grid grid-cols-2 gap-4"},T={class:"flex flex-col gap-1"},U={class:"flex flex-col gap-1"},A={class:"grid grid-cols-2 gap-4"},B={class:"flex flex-col gap-1"},M={class:"flex flex-col gap-1"},O={__name:"EditProductSheet",props:{open:Boolean,product:Object},emits:["close","save"],setup(e,{emit:l}){const i=e,d=l,o=h({product_id:"",name:"",sku:"",sell_price:0,cost_price:0,stock:0});k([()=>i.open,()=>i.product],([m,t])=>{m&&(t?Object.assign(o,{product_id:t.product_id||"",name:t.name||"",sku:t.sku||"",sell_price:t.sell_price||0,cost_price:t.cost_price||0,stock:t.stock||0}):Object.assign(o,{product_id:"",name:"",sku:"",sell_price:0,cost_price:0,stock:0}))},{immediate:!0});function f(){d("close")}function x(){d("save",{...o})}return(m,t)=>e.open?(w(),_("div",{key:0,class:"fixed inset-0 z-50 bg-black/30 backdrop-blur-sm",onClick:f},[s("div",{class:"absolute bottom-0 w-full bg-white rounded-t-3xl p-5 pb-24 space-y-4 shadow-2xl",onClick:t[5]||(t[5]=P(()=>{},["stop"]))},[s("div",S,[s("h3",C,y(e.product?"Edit Product":"Add Product"),1)]),s("div",E,[s("div",I,[t[6]||(t[6]=s("label",{class:"text-xs font-bold text-slate-500 uppercase ml-1"},"Product Name",-1)),a(s("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>o.name=r),class:"w-full border border-slate-200 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"e.g. Mineral Water"},null,512),[[c,o.name]])]),s("div",V,[s("div",T,[t[7]||(t[7]=s("label",{class:"text-xs font-bold text-slate-500 uppercase ml-1"},"Sale Price (RM)",-1)),a(s("input",{"onUpdate:modelValue":t[1]||(t[1]=r=>o.sell_price=r),type:"number",class:"w-full border border-slate-200 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 outline-none"},null,512),[[c,o.sell_price,void 0,{number:!0}]])]),s("div",U,[t[8]||(t[8]=s("label",{class:"text-xs font-bold text-slate-500 uppercase ml-1"},"Cost Price (RM)",-1)),a(s("input",{"onUpdate:modelValue":t[2]||(t[2]=r=>o.cost_price=r),type:"number",class:"w-full border border-slate-200 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 outline-none"},null,512),[[c,o.cost_price,void 0,{number:!0}]])])]),s("div",A,[s("div",B,[t[9]||(t[9]=s("label",{class:"text-xs font-bold text-slate-500 uppercase ml-1"},"Current Stock",-1)),a(s("input",{"onUpdate:modelValue":t[3]||(t[3]=r=>o.stock=r),type:"number",class:"w-full border border-slate-200 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 outline-none"},null,512),[[c,o.stock,void 0,{number:!0}]])]),s("div",M,[t[10]||(t[10]=s("label",{class:"text-xs font-bold text-slate-500 uppercase ml-1"},"Source (SKU)",-1)),a(s("input",{"onUpdate:modelValue":t[4]||(t[4]=r=>o.sku=r),class:"w-full border border-slate-200 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"sku code"},null,512),[[c,o.sku]])])])]),s("div",{class:"flex gap-3 pt-4"},[s("button",{class:"flex-1 bg-slate-100 text-slate-600 font-bold rounded-xl py-3 active:scale-95 transition-all",onClick:f}," Cancel "),s("button",{class:"flex-1 bg-slate-800 text-white font-bold rounded-xl py-3 shadow-lg active:scale-95 transition-all",onClick:x}," Save Changes ")])])])):v("",!0)}};export{O as _,L as u};
