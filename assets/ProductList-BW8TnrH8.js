import{i as k,a as C,d as M,j as P,w as U,k as D,c as p,l as E,o as f,b as t,t as x,m as b,v as m,p as B,q as N,f as O,h as z,u as S,F as w,s as A,r as $,n as y,x as j}from"./index-DH8ys1pC.js";const v={getAll(e="ACTIVE"){return C({resource:"product",status:e})},getById(e){return C({resource:"product",id:e})},create(e){return k({resource:"product",method:"POST",...e})},update(e){return k(e)},delete(e){return k({resource:"product",method:"DELETE",product_id:e})}},F=M("product",{state:()=>({items:[],loading:!1,error:null}),actions:{async fetchProducts(e="ACTIVE"){this.loading=!0,this.error=null;try{const n=await v.getAll(e);this.items=n.data||[]}catch(n){this.error=n.message||"Failed to load products"}finally{this.loading=!1}},async addProduct(e){P().info("Adding product..."),await v.create(e),await this.fetchProducts()},async updateProduct(e){const n=P(),c=this.items.findIndex(s=>s.product_id===e.product_id);if(c===-1)return;const d={...this.items[c]};this.items[c]={...e};try{const s={resource:"product",method:"PUT",product_id:e.product_id,name:e.name,sku:e.sku,sell_price:e.sell_price,cost_price:e.cost_price,stock:e.stock,status:e.status};await v.update(s),n.success("Product updated")}catch(s){this.items[c]=d,console.error("Update product failed",s),n.error("Failed to update product")}},async deleteProduct(e){await v.delete(e),await this.fetchProducts()}}}),I={class:"flex justify-between items-center border-b pb-2"},R={class:"text-lg font-bold text-slate-800"},L={class:"space-y-4"},q={class:"flex flex-col gap-1"},G={class:"grid grid-cols-2 gap-4"},K={class:"flex flex-col gap-1"},W={class:"flex flex-col gap-1"},H={class:"grid grid-cols-2 gap-4"},J={class:"flex flex-col gap-1"},Q={class:"flex flex-col gap-1"},X={__name:"EditProductSheet",props:{open:Boolean,product:Object},emits:["close","save"],setup(e,{emit:n}){const c=e,d=n,s=D({product_id:"",name:"",sku:"",sell_price:0,cost_price:0,stock:0});U(()=>c.open,g=>{g&&(c.product?Object.assign(s,c.product):Object.assign(s,{product_id:"",name:"",sku:"",sell_price:0,cost_price:0,stock:0}))});function u(){d("close")}function h(){d("save",{...s})}return(g,o)=>e.open?(f(),p("div",{key:0,class:"fixed inset-0 z-50 bg-black/30 backdrop-blur-sm",onClick:u},[t("div",{class:"absolute bottom-0 w-full bg-white rounded-t-3xl p-5 pb-24 space-y-4 shadow-2xl",onClick:o[5]||(o[5]=B(()=>{},["stop"]))},[t("div",I,[t("h3",R,x(e.product?"Edit Product":"Add Product"),1)]),t("div",L,[t("div",q,[o[6]||(o[6]=t("label",{class:"text-xs font-bold text-slate-500 uppercase ml-1"},"Product Name",-1)),b(t("input",{"onUpdate:modelValue":o[0]||(o[0]=i=>s.name=i),class:"w-full border border-slate-200 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"e.g. Mineral Water"},null,512),[[m,s.name]])]),t("div",G,[t("div",K,[o[7]||(o[7]=t("label",{class:"text-xs font-bold text-slate-500 uppercase ml-1"},"Sale Price (RM)",-1)),b(t("input",{"onUpdate:modelValue":o[1]||(o[1]=i=>s.sell_price=i),type:"number",class:"w-full border border-slate-200 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 outline-none"},null,512),[[m,s.sell_price,void 0,{number:!0}]])]),t("div",W,[o[8]||(o[8]=t("label",{class:"text-xs font-bold text-slate-500 uppercase ml-1"},"Cost Price (RM)",-1)),b(t("input",{"onUpdate:modelValue":o[2]||(o[2]=i=>s.cost_price=i),type:"number",class:"w-full border border-slate-200 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 outline-none"},null,512),[[m,s.cost_price,void 0,{number:!0}]])])]),t("div",H,[t("div",J,[o[9]||(o[9]=t("label",{class:"text-xs font-bold text-slate-500 uppercase ml-1"},"Current Stock",-1)),b(t("input",{"onUpdate:modelValue":o[3]||(o[3]=i=>s.stock=i),type:"number",class:"w-full border border-slate-200 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 outline-none"},null,512),[[m,s.stock,void 0,{number:!0}]])]),t("div",Q,[o[10]||(o[10]=t("label",{class:"text-xs font-bold text-slate-500 uppercase ml-1"},"Source (SKU)",-1)),b(t("input",{"onUpdate:modelValue":o[4]||(o[4]=i=>s.sku=i),class:"w-full border border-slate-200 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"sku code"},null,512),[[m,s.sku]])])])]),t("div",{class:"flex gap-3 pt-4"},[t("button",{class:"flex-1 bg-slate-100 text-slate-600 font-bold rounded-xl py-3 active:scale-95 transition-all",onClick:u}," Cancel "),t("button",{class:"flex-1 bg-slate-800 text-white font-bold rounded-xl py-3 shadow-lg active:scale-95 transition-all",onClick:h}," Save Changes ")])])])):E("",!0)}},Y={class:"p-4 pb-24 space-y-4 bg-slate-50 min-h-screen"},Z={key:0,class:"space-y-3"},tt={class:"space-y-0.5 max-w-[70%]"},et={class:"font-bold text-slate-800 truncate leading-tight"},st={class:"text-[10px] text-slate-400 font-medium tracking-wide uppercase"},ot={class:"text-xs font-semibold text-slate-500 pt-1"},lt={class:"text-slate-400 font-normal"},nt={class:"text-emerald-600 font-bold"},rt={class:"flex gap-2 mt-2"},at=["onClick","disabled"],it=["onClick"],ct={class:"absolute right-0 top-0 bottom-0 z-10 flex h-full"},dt=["onClick"],ut=["onClick"],ft={__name:"ProductList",setup(e){const n=F(),c=N(),d=P(),s=$(null),u=$(!1);O(()=>{n.fetchProducts()});function h(l){l._showActions===void 0&&(l._showActions=!1),n.items.forEach(r=>{r.product_id!==l.product_id&&(r._showActions=!1)}),l._showActions=!l._showActions}function g(){s.value=null,u.value=!0}function o(l){if(l.stock<=0){d.error("Out of stock");return}c.add(l),d.success("Added to cart")}function i(l){l._showActions=!1,s.value=l,u.value=!0}function V(l){confirm(`Delete ${l.name}?`)&&(l._showActions=!1,n.deleteProduct(l.product_id),d.success("Product deleted"))}function T(l){s.value?(n.updateProduct(l),d.success("Product updated")):(n.addProduct(l),d.success("Product added")),u.value=!1}return(l,r)=>(f(),p(w,null,[t("div",Y,[t("div",{class:"flex justify-between items-center"},[r[2]||(r[2]=t("h2",{class:"text-xl font-bold text-slate-800 tracking-tight"},"Products",-1)),t("button",{class:"w-10 h-10 flex items-center justify-center rounded-xl bg-slate-800 text-white shadow-sm active:scale-90 transition-all",onClick:g},[...r[1]||(r[1]=[t("span",{class:"text-xl"},"+",-1)])])]),S(n).loading?(f(),p("div",Z,[(f(),p(w,null,A(5,a=>t("div",{key:a,class:"h-28 bg-slate-200 rounded-2xl animate-pulse"})),64))])):E("",!0),(f(!0),p(w,null,A(S(n).items,a=>(f(),p("div",{key:a.product_id,class:"bg-white rounded-2xl shadow-sm border border-slate-100 relative overflow-hidden h-28 flex"},[t("div",{class:y(["absolute inset-0 z-20 bg-white p-4 flex justify-between items-center transition-transform duration-300 ease-in-out",a._showActions?"-translate-x-32":"translate-x-0"])},[t("div",tt,[t("h3",et,x(a.name),1),t("p",st,x(a.sku),1),t("div",ot,[r[3]||(r[3]=j(" Cost: ",-1)),t("span",lt,"RM "+x(a.cost_price),1),r[4]||(r[4]=j(" Â· Sell: ",-1)),t("span",nt,"RM "+x(a.sell_price),1)]),t("div",rt,[t("span",{class:y(["text-[10px] font-bold px-2 py-1 rounded-lg shadow-sm border",a.stock>0?"bg-emerald-50 text-emerald-600 border-emerald-100":"bg-rose-50 text-rose-600 border-rose-100"])}," Stock: "+x(a.stock),3),t("button",{onClick:_=>o(a),disabled:a.stock<=0,class:"text-[10px] font-bold px-3 py-1 rounded-lg bg-amber-400 text-amber-900 shadow-sm active:scale-95 disabled:opacity-50 disabled:grayscale transition-all"}," ðŸ›’ Add to Cart ",8,at)])]),t("button",{onClick:_=>h(a),class:"w-10 h-10 flex items-center justify-center bg-transparent border-none text-blue-500 active:scale-90 transition-all outline-none"},[t("i",{class:y(["fa text-xl transition-transform duration-300",a._showActions?"fa-chevron-right":"fa-chevron-left"]),"aria-hidden":"true"},null,2)],8,it)],2),t("div",ct,[t("button",{class:"w-16 bg-sky-500 text-white flex flex-col items-center justify-center gap-1 active:bg-sky-600 transition-colors",onClick:_=>i(a)},[...r[5]||(r[5]=[t("span",{class:"text-lg"},"âœï¸",-1),t("span",{class:"text-[9px] font-bold uppercase"},"Edit",-1)])],8,dt),t("button",{class:"w-16 bg-rose-400 text-white flex flex-col items-center justify-center gap-1 active:bg-rose-500 transition-colors",onClick:_=>V(a)},[...r[6]||(r[6]=[t("span",{class:"text-lg"},"ðŸ—‘",-1),t("span",{class:"text-[9px] font-bold uppercase tracking-tighter"},"Delete",-1)])],8,ut)])]))),128))]),z(X,{open:u.value,product:s.value,onClose:r[0]||(r[0]=a=>u.value=!1),onSave:T},null,8,["open","product"])],64))}};export{ft as default};
