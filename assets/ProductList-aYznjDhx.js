import{i as w,a as P,d as T,j as y,w as M,k as U,c as x,l as j,o as m,b as t,t as p,m as f,v as b,p as D,q as z,f as B,h as N,u as C,F as S,s as O,r as A,n as k,x as $}from"./index-BjrFz6-z.js";const v={getAll(e="ACTIVE"){return P({resource:"product",status:e})},getById(e){return P({resource:"product",id:e})},create(e){return w({resource:"product",method:"POST",...e})},update(e){return w(e)},delete(e){return w({resource:"product",method:"DELETE",product_id:e})}},F=T("product",{state:()=>({items:[],loading:!1,error:null}),actions:{async fetchProducts(e="ACTIVE"){this.loading=!0,this.error=null;try{const r=await v.getAll(e);this.items=r.data||[]}catch(r){this.error=r.message||"Failed to load products"}finally{this.loading=!1}},async addProduct(e){y().info("Adding product..."),await v.create(e),await this.fetchProducts()},async updateProduct(e){const r=y(),d=this.items.findIndex(s=>s.product_id===e.product_id);if(d===-1)return;const c={...this.items[d]};this.items[d]={...e};try{const s={resource:"product",method:"PUT",product_id:e.product_id,name:e.name,sku:e.sku,sell_price:e.sell_price,cost_price:e.cost_price,stock:e.stock,status:e.status};await v.update(s),r.success("Product updated")}catch(s){this.items[d]=c,console.error("Update product failed",s),r.error("Failed to update product")}},async deleteProduct(e){await v.delete(e),await this.fetchProducts()}}}),I={class:"flex justify-between items-center border-b pb-2"},R={class:"text-lg font-bold text-slate-800"},L={class:"space-y-4"},q={class:"flex flex-col gap-1"},G={class:"grid grid-cols-2 gap-4"},K={class:"flex flex-col gap-1"},W={class:"flex flex-col gap-1"},H={class:"grid grid-cols-2 gap-4"},J={class:"flex flex-col gap-1"},Q={class:"flex flex-col gap-1"},X={__name:"EditProductSheet",props:{open:Boolean,product:Object},emits:["close","save"],setup(e,{emit:r}){const d=e,c=r,s=U({product_id:"",name:"",sku:"",sell_price:0,cost_price:0,stock:0});M(()=>d.open,g=>{g&&(d.product?Object.assign(s,d.product):Object.assign(s,{product_id:"",name:"",sku:"",sell_price:0,cost_price:0,stock:0}))});function u(){c("close")}function h(){c("save",{...s})}return(g,o)=>e.open?(m(),x("div",{key:0,class:"fixed inset-0 z-50 bg-black/30 backdrop-blur-sm",onClick:u},[t("div",{class:"absolute bottom-0 w-full bg-white rounded-t-3xl p-5 pb-24 space-y-4 shadow-2xl",onClick:o[5]||(o[5]=D(()=>{},["stop"]))},[t("div",I,[t("h3",R,p(e.product?"Edit Product":"Add Product"),1)]),t("div",L,[t("div",q,[o[6]||(o[6]=t("label",{class:"text-xs font-bold text-slate-500 uppercase ml-1"},"Product Name",-1)),f(t("input",{"onUpdate:modelValue":o[0]||(o[0]=i=>s.name=i),class:"w-full border border-slate-200 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"e.g. Mineral Water"},null,512),[[b,s.name]])]),t("div",G,[t("div",K,[o[7]||(o[7]=t("label",{class:"text-xs font-bold text-slate-500 uppercase ml-1"},"Sale Price (RM)",-1)),f(t("input",{"onUpdate:modelValue":o[1]||(o[1]=i=>s.sell_price=i),type:"number",class:"w-full border border-slate-200 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 outline-none"},null,512),[[b,s.sell_price,void 0,{number:!0}]])]),t("div",W,[o[8]||(o[8]=t("label",{class:"text-xs font-bold text-slate-500 uppercase ml-1"},"Cost Price (RM)",-1)),f(t("input",{"onUpdate:modelValue":o[2]||(o[2]=i=>s.cost_price=i),type:"number",class:"w-full border border-slate-200 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 outline-none"},null,512),[[b,s.cost_price,void 0,{number:!0}]])])]),t("div",H,[t("div",J,[o[9]||(o[9]=t("label",{class:"text-xs font-bold text-slate-500 uppercase ml-1"},"Current Stock",-1)),f(t("input",{"onUpdate:modelValue":o[3]||(o[3]=i=>s.stock=i),type:"number",class:"w-full border border-slate-200 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 outline-none"},null,512),[[b,s.stock,void 0,{number:!0}]])]),t("div",Q,[o[10]||(o[10]=t("label",{class:"text-xs font-bold text-slate-500 uppercase ml-1"},"Source (SKU)",-1)),f(t("input",{"onUpdate:modelValue":o[4]||(o[4]=i=>s.sku=i),class:"w-full border border-slate-200 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"sku code"},null,512),[[b,s.sku]])])])]),t("div",{class:"flex gap-3 pt-4"},[t("button",{class:"flex-1 bg-slate-100 text-slate-600 font-bold rounded-xl py-3 active:scale-95 transition-all",onClick:u}," Cancel "),t("button",{class:"flex-1 bg-slate-800 text-white font-bold rounded-xl py-3 shadow-lg active:scale-95 transition-all",onClick:h}," Save Changes ")])])])):j("",!0)}},Y={class:"p-4 pb-24 space-y-4 bg-slate-50 min-h-screen"},Z={key:0,class:"text-center py-20 text-slate-400"},tt={class:"space-y-0.5 max-w-[70%]"},et={class:"font-bold text-slate-800 truncate leading-tight"},st={class:"text-[10px] text-slate-400 font-medium tracking-wide uppercase"},ot={class:"text-xs font-semibold text-slate-500 pt-1"},lt={class:"text-slate-400 font-normal"},nt={class:"text-emerald-600 font-bold"},rt={class:"flex gap-2 mt-2"},at=["onClick","disabled"],it=["onClick"],dt={class:"absolute right-0 top-0 bottom-0 z-10 flex h-full"},ct=["onClick"],ut=["onClick"],ft={__name:"ProductList",setup(e){const r=F(),d=z(),c=y(),s=A(null),u=A(!1);B(()=>{r.fetchProducts()});function h(l){l._showActions===void 0&&(l._showActions=!1),r.items.forEach(n=>{n.product_id!==l.product_id&&(n._showActions=!1)}),l._showActions=!l._showActions}function g(){s.value=null,u.value=!0}function o(l){if(l.stock<=0){c.error("Out of stock");return}d.add(l),c.success("Added to cart")}function i(l){l._showActions=!1,s.value=l,u.value=!0}function E(l){confirm(`Delete ${l.name}?`)&&(l._showActions=!1,r.deleteProduct(l.product_id),c.success("Product deleted"))}function V(l){s.value?(r.updateProduct(l),c.success("Product updated")):(r.addProduct(l),c.success("Product added")),u.value=!1}return(l,n)=>(m(),x(S,null,[t("div",Y,[t("div",{class:"flex justify-between items-center"},[n[2]||(n[2]=t("h2",{class:"text-xl font-bold text-slate-800 tracking-tight"},"Products",-1)),t("button",{class:"w-10 h-10 flex items-center justify-center rounded-xl bg-slate-800 text-white shadow-sm active:scale-90 transition-all",onClick:g},[...n[1]||(n[1]=[t("span",{class:"text-xl"},"+",-1)])])]),C(r).loading?(m(),x("div",Z,[...n[3]||(n[3]=[t("div",{class:"animate-spin inline-block w-8 h-8 border-4 border-slate-300 border-t-slate-800 rounded-full mb-4"},null,-1),t("p",{class:"font-bold text-sm"},"Synchronizing Products...",-1)])])):j("",!0),(m(!0),x(S,null,O(C(r).items,a=>(m(),x("div",{key:a.product_id,class:"bg-white rounded-2xl shadow-sm border border-slate-100 relative overflow-hidden h-28 flex"},[t("div",{class:k(["absolute inset-0 z-20 bg-white p-4 flex justify-between items-center transition-transform duration-300 ease-in-out",a._showActions?"-translate-x-32":"translate-x-0"])},[t("div",tt,[t("h3",et,p(a.name),1),t("p",st,p(a.sku),1),t("div",ot,[n[4]||(n[4]=$(" Cost: ",-1)),t("span",lt,"RM "+p(a.cost_price),1),n[5]||(n[5]=$(" Â· Sell: ",-1)),t("span",nt,"RM "+p(a.sell_price),1)]),t("div",rt,[t("span",{class:k(["text-[10px] font-bold px-2 py-1 rounded-lg shadow-sm border",a.stock>0?"bg-emerald-50 text-emerald-600 border-emerald-100":"bg-rose-50 text-rose-600 border-rose-100"])}," Stock: "+p(a.stock),3),t("button",{onClick:_=>o(a),disabled:a.stock<=0,class:"text-[10px] font-bold px-3 py-1 rounded-lg bg-amber-400 text-amber-900 shadow-sm active:scale-95 disabled:opacity-50 disabled:grayscale transition-all"}," ðŸ›’ Add to Cart ",8,at)])]),t("button",{onClick:_=>h(a),class:"w-10 h-10 flex items-center justify-center bg-transparent border-none text-blue-500 active:scale-90 transition-all outline-none"},[t("i",{class:k(["fa text-xl transition-transform duration-300",a._showActions?"fa-chevron-right":"fa-chevron-left"]),"aria-hidden":"true"},null,2)],8,it)],2),t("div",dt,[t("button",{class:"w-16 bg-sky-500 text-white flex flex-col items-center justify-center gap-1 active:bg-sky-600 transition-colors",onClick:_=>i(a)},[...n[6]||(n[6]=[t("span",{class:"text-lg"},"âœï¸",-1),t("span",{class:"text-[9px] font-bold uppercase"},"Edit",-1)])],8,ct),t("button",{class:"w-16 bg-rose-400 text-white flex flex-col items-center justify-center gap-1 active:bg-rose-500 transition-colors",onClick:_=>E(a)},[...n[7]||(n[7]=[t("span",{class:"text-lg"},"ðŸ—‘",-1),t("span",{class:"text-[9px] font-bold uppercase tracking-tighter"},"Delete",-1)])],8,ut)])]))),128))]),N(X,{open:u.value,product:s.value,onClose:n[0]||(n[0]=a=>u.value=!1),onSave:V},null,8,["open","product"])],64))}};export{ft as default};
